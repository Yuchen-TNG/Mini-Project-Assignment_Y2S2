@model List<Google.Cloud.Firestore.DocumentSnapshot>

@{
    ViewData["Title"] = "My Posts";

    string currentCategory = ViewBag.Category as string;
    string currentStatus = ViewBag.Status as string;
}

<link rel="stylesheet" href="~/css/index.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/mypost.css" asp-append-version="true" />

<div class="parent">

    <!-- 🔹 LEFT FILTER PANEL -->
    <div class="left-container">

        <div class="filter-container">
            <h1>My Posts</h1>
            <p>Filter your posted items</p>
        </div>

        <div class="line"></div>

        <div class="filter-list">

            <a href="@Url.Action("MyPost")"
               class="filter-item @(string.IsNullOrEmpty(currentCategory) && string.IsNullOrEmpty(currentStatus) ? "active" : "")">
                📋 All
            </a>

            <a href="@Url.Action("MyPost", new { category = "LOSTITEM" })"
               class="filter-item @(currentCategory == "LOSTITEM" ? "active" : "")">
                🔍 Lost
            </a>

            <a href="@Url.Action("MyPost", new { category = "FOUNDITEM" })"
               class="filter-item @(currentCategory == "FOUNDITEM" ? "active" : "")">
                📦 Found
            </a>

            <a href="@Url.Action("MyPost", new { status = "CLAIMED" })"
               class="filter-item @(currentStatus == "CLAIMED" ? "active" : "")">
                🏁 Claimed
            </a>

        </div>

    </div>

    <div class="middle-line"></div>

    <!-- 🔹 RIGHT CONTENT -->
    <div class="right-container">

        <div class="right-container-top">
            <h2>
                @(currentStatus == "CLAIMED"
                                ? "Claimed Items"
                                : string.IsNullOrEmpty(currentCategory)
                                ? "All Items"
                                : currentCategory == "LOSTITEM" ? "Lost Items" : "Found Items")
            </h2>
            <hr />
        </div>

        <div class="right-container-bottom">

            <div class="cardparent">

                @if (!Model.Any())
                {
                    <p class="not_available">No items found.</p>
                }
                else
                {
                    foreach (var doc in Model)
                    {
                        var name = doc.GetValue<string>("IName");
                        var category = doc.GetValue<string>("Category");
                        var date = doc.GetValue<DateTime>("Date").ToString("dd MMM yyyy");
                        var images = doc.ContainsField("Images")
                        ? doc.GetValue<List<string>>("Images")
                        : new List<string>();

                        var imageUrl = images.Any()
                        ? images[0]
                        : Url.Content("~/images/no-image.png");

                        var itemId = doc.GetValue<long>("ItemID");

                        <a href="@Url.Action("MyPostDetails", "User", new { itemId = itemId })">
                            <div class="card">
                                <img src="@imageUrl" class="card-img" />

                                <div class="card-details">
                                    <p class="category">@category</p>
                                    <p><strong>@name</strong></p>
                                    <p>@date</p>
                                </div>
                            </div>
                        </a>
                    }
                }

            </div>

        </div>

    </div>

</div>
