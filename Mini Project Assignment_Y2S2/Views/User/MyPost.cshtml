@model List<Google.Cloud.Firestore.DocumentSnapshot>

@{
    ViewData["Title"] = "My Posts";

    string currentCategory = ViewBag.Category as string;
    string currentStatus = ViewBag.Status as string;
}

<link rel="stylesheet" href="~/css/index.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/mypost.css" asp-append-version="true" />

<div class="parent">

    <!-- 🔹 LEFT FILTER PANEL -->
    <div class="left-container">

        <div class="filter-container">
            <h1>My Posts</h1>
            <p>Filter your posted items</p>
        </div>

        <div class="line"></div>

        <div class="filter-list">

            <a href="@Url.Action("MyPost")"
               class="filter-item @(string.IsNullOrEmpty(currentCategory) && string.IsNullOrEmpty(currentStatus) ? "active" : "")">
                📋 All
            </a>

            <a href="@Url.Action("MyPost", new { category = "LOSTITEM" })"
               class="filter-item @(currentCategory == "LOSTITEM" ? "active" : "")">
                🔍 Lost
            </a>

            <a href="@Url.Action("MyPost", new { category = "FOUNDITEM" })"
               class="filter-item @(currentCategory == "FOUNDITEM" ? "active" : "")">
                📦 Found
            </a>

            <a href="@Url.Action("MyPost", new { status = "CLAIMED" })"
               class="filter-item @(currentStatus == "CLAIMED" ? "active" : "")">
                🏁 Claimed
            </a>

        </div>

    </div>

    <!-- MIDDLE LINE -->
    <div class="middle-line"></div>

    <!-- 🔹 RIGHT CONTENT -->
    <div class="right-container">

        <div class="right-container-top">
            <h2>
                @(currentStatus == "CLAIMED"
                                ? "Claimed Items"
                                : string.IsNullOrEmpty(currentCategory)
                                ? "All Items"
                                : currentCategory == "LOSTITEM" ? "Lost Items" : "Found Items")
            </h2>
            <hr />
        </div>

        <div class="right-container-bottom">

            <div class="cardparent">

                @if (!Model.Any())
                {
                    <p class="not_available">No items found.</p>
                }
                else
                {
                    foreach (var doc in Model)
                    {
                        var data = doc.ToDictionary();

                        string image = data.ContainsKey("Images")
                        ? ((List<object>)data["Images"]).FirstOrDefault()?.ToString()
                        : "/images/no-image.png";

                        <div class="card">
                            <img src="@image" class="card-img" />

                            <div class="card-details">
                                <p class="category">@data["Category"]</p>
                                <p><b>@data["IName"]</b></p>
                                <p>@data["Description"]</p>

                                @if (currentStatus == "CLAIMED")
                                {
                                    <span class="claimed-badge">CLAIMED</span>
                                }
                            </div>
                        </div>
                    }
                }

            </div>

        </div>

    </div>

</div>
