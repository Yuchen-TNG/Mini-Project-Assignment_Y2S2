@model Mini_Project_Assignment_Y2S2.Models.Item

@{
    ViewData["Title"] = "Post Details";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="mb-6">
    <div class="flex items-center gap-3 mb-2">
        <a href="/PostManagement" class="text-blue-600 hover:text-blue-800">
            <i class="fas fa-arrow-left"></i> Back to Post Management
        </a>
    </div>
    <h2 class="text-xl font-bold">Post Details</h2>
    <p class="text-gray-400 text-sm">View complete post information</p>
</div>

@if (TempData["Success"] != null)
{
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4">
        @TempData["Success"]
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
        @TempData["Error"]
    </div>
}

<div class="bg-white rounded-lg shadow-lg overflow-hidden">
    <div class="p-6">
        <div class="flex gap-6 mb-6">
            <div class="w-80 h-80 bg-gray-200 rounded-lg flex items-center justify-center shrink-0 overflow-hidden">
                @if (Model.Images != null && Model.Images.Count > 0)
                {
                    <img src="@Model.Images[0]" alt="Item Image" class="w-full h-full object-cover" />
                }
                else
                {
                    <i class="far fa-image text-6xl text-gray-400"></i>
                }
            </div>

            <div class="flex-1">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-2xl font-bold">@(Model.IType ?? "Unknown Item")</h3>
                    <span class="text-sm font-bold uppercase px-3 py-1 rounded @(Model.IStatus == "PENDING" ? "bg-yellow-100 text-yellow-800" : "bg-gray-100 text-gray-800")">
                        @(Model.IStatus ?? "Pending")
                    </span>
                </div>

                <div class="space-y-3 mb-6">
                    <div class="flex items-start">
                        <span class="font-semibold w-32 text-gray-700">Category:</span>
                        <span class="text-gray-900">@(Model.Category ?? "N/A")</span>
                    </div>
                    <div class="flex items-start">
                        <span class="font-semibold w-32 text-gray-700">Type:</span>
                        <span class="text-gray-900">@(Model.IType ?? "N/A")</span>
                    </div>
                    <div class="flex items-start">
                        <span class="font-semibold w-32 text-gray-700">Location Name:</span>
                        <span class="text-gray-900">@(Model.LocationName ?? "N/A")</span>
                    </div>
                    <div class="flex items-start">
                        <span class="font-semibold w-32 text-gray-700">Posted By:</span>
                        <span class="text-gray-900">@(Model.UserID ?? "N/A")</span>
                    </div>
                    <div class="flex items-start">
                        <span class="font-semibold w-32 text-gray-700">Date Posted:</span>
                        <span class="text-gray-900">@Model.Date.ToString("dd MMM yyyy")</span>
                    </div>
                </div>

                <div class="mb-6">
                    <h4 class="font-semibold text-gray-700 mb-2">Description:</h4>
                    <p class="text-gray-900 leading-relaxed whitespace-pre-wrap">@(Model.Idescription ?? "No description available")</p>
                </div>

                @if (Model.Images != null && Model.Images.Count > 1)
                {
                    <div class="mb-6">
                        <h4 class="font-semibold text-gray-700 mb-3">Additional Images:</h4>
                        <div class="grid grid-cols-4 gap-3">
                            @for (int i = 1; i < Model.Images.Count; i++)
                            {
                                <div class="w-full h-24 bg-gray-200 rounded overflow-hidden">
                                    <img src="@Model.Images[i]" alt="Additional Image @(i + 1)" class="w-full h-full object-cover cursor-pointer hover:opacity-75 transition" onclick="viewImage('@Model.Images[i]')" />
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>

        <div class="border-t pt-6 flex gap-4 justify-end">
            <form action="/PostManagement/Approve/@Model.ItemID" method="post">
                <button type="submit" class="bg-green-500 hover:bg-green-600 text-white px-8 py-2 rounded-lg font-medium transition shadow">
                    <i class="fas fa-check mr-2"></i>Approve Post
                </button>
            </form>
            <form action="/PostManagement/Reject/@Model.ItemID" method="post">
                <button type="submit" class="bg-red-500 hover:bg-red-600 text-white px-8 py-2 rounded-lg font-medium transition shadow">
                    <i class="fas fa-times mr-2"></i>Reject Post
                </button>
            </form>
        </div>
    </div>
</div>

<div id="imageModal" class="hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center" onclick="closeImageModal()">
    <div class="max-w-4xl max-h-screen p-4">
        <img id="modalImage" src="/placeholder.svg" alt="Full size image" class="max-w-full max-h-full rounded-lg" />
    </div>
</div>

@section Scripts {
    <script>
        function viewImage(imageSrc) {
            document.getElementById('modalImage').src = imageSrc;
            document.getElementById('imageModal').classList.remove('hidden');
        }

        function closeImageModal() {
            document.getElementById('imageModal').classList.add('hidden');
        }
    </script>
}
